import{a as c}from"./authGuard-A4jdk1Y4.js";import{h as i}from"./headers-BH8MPi27.js";import{b as d}from"./app-L8FS1TIH.js";class p{constructor(t="https://v2.api.noroff.dev/social/profiles"){this.baseApiUrl=t}async getProfile(t,s=!1){if(!t)throw new Error("Username is required to fetch a profile.");const r=`${this.baseApiUrl}/${t}?_posts=${s}`;console.log("Fetching from API URL:",r);try{const e=i();console.log("Headers being sent:",{"Content-Type":e.get("Content-Type"),Authorization:e.get("Authorization")});const a=await fetch(r,{headers:e});if(!a.ok)throw console.error("API response status:",a.status),new Error(`Failed to fetch profile data: ${a.status}`);const n=await a.json();return console.log("Profile data:",n),console.log("Full API response for profile:",n),n}catch(e){throw console.error("Error fetching profile data:",e.message),e}}async getProfiles(t=10,s=1){const r=`${this.baseApiUrl}?limit=${t}&page=${s}`;try{const e=await fetch(r,{headers:i()});if(!e.ok)throw new Error("Failed to fetch profiles");const a=await e.json();return console.log("Profiles data:",a),a}catch(e){throw console.error("Error fetching profiles:",e.message),e}}}c();console.log("Profile page script is running");(async function(){document.readyState==="loading"?(console.log("DOM is still loading, setting event listener"),document.addEventListener("DOMContentLoaded",l)):(console.log("DOM already loaded, running setup directly"),l())})();async function l(){console.log("Setting up profile page");try{const o=new p,t=JSON.parse(localStorage.getItem("userDetails"));if(console.log("User details from localStorage:",t),!t||!t.name){console.error("User details are missing or invalid.");return}const s=t.name;console.log("Fetching user profile for:",s);const r=await o.getProfile(s,!0);if(console.log("Full API response for userProfile:",r),!r||!r.data){console.error("Failed to fetch user profile data:",r);return}const e=r.data.posts||[];if(!Array.isArray(e)){console.error("Invalid posts structure:",e);return}f(r.data),g(e,r.data.name)}catch(o){console.error("Error fetching user profile or posts:",o.message)}}function f(o){const t=document.getElementById("profile-details");if(console.log("This is the username:",o.name),!t){console.error("Profile details section not found.");return}t.innerHTML=`
    <h2>${o.name}</h2>
    <p>Email: ${o.email}</p>
    ${o.bio?`<p>Bio: ${o.bio}</p>`:""}
    ${o.avatar?.url?`<img src="${o.avatar.url}" alt="${o.avatar.alt||"Avatar"}" />`:""}
    ${o.banner?.url?`<img src="${o.banner.url}" alt="${o.banner.alt||"Banner"}" />`:""}
  `}function g(o,t){const s=document.getElementById("user-posts");if(console.log("Posts array:",o),!s){console.error("User posts section not found.");return}if(!o.length){s.innerHTML=`<h2>${t}'s Posts</h2><p>No posts found.</p>`;return}const r=document.createElement("div");r.className="post-list",o.forEach(e=>{const a=document.createElement("div");a.className="post-card",a.innerHTML=`
      <div class="post-content">
        <h3>
          <a href="${d}/post/?id=${e.id}" class="post-link">${e.title}</a>
        </h3>
        <p>${e.body}</p>
        ${e.image?`<img src="${e.image}" alt="Post image" />`:"<p>No image available</p>"}
      </div>
    `,r.appendChild(a)}),s.innerHTML=`<h2>${t}'s Posts</h2>`,s.appendChild(r)}
